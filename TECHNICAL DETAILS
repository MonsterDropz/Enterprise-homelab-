Enterprise Home Lab on Proxmox VE

A comprehensive, self-contained home lab project built on Proxmox VE to emulate enterprise-grade IT infrastructure. This project demonstrates the integration of core services including centralized identity management, network security, segmentation, and infrastructure monitoring.

ğŸš€ Lab Overview & Architecture

This project provisions a multi-tier environment within a single Proxmox host. The core components and their network segmentation are outlined below:

Logical Network Diagram

Â Â Â Â +-----------------------------------------------------------------------------------+
Â Â Â Â |Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Proxmox Host (Physical/Virtual) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |
Â Â Â Â | +--------------+ Â  Â  +---------------------+ Â  Â  +-------------------------------+ |
Â Â Â Â | |Â  Â  Â  Â  Â  Â  Â  | Â  Â  | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | Â  Â  | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | |
Â Â Â Â | |Â  pfSense VMÂ  | Â  Â  |Â  DC01 (Win Srv) Â  Â  | Â  Â  |Â  Zabbix (Ubuntu Server) Â  Â  Â  | |
Â Â Â Â | |Â  (Router)Â  Â  | Â  Â  |Â  - AD DSÂ  Â  Â  Â  Â  Â  | Â  Â  |Â  - Monitoring ServerÂ  Â  Â  Â  Â  | |
Â Â Â Â | |Â  - VLAN Trunk| Â  Â  |Â  - DNSÂ  Â  Â  Â  Â  Â  Â  | Â  Â  | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | |
Â Â Â Â | |Â  Â  Â  Â  Â  Â  Â  | Â  Â  |Â  - DHCP Â  Â  Â  Â  Â  Â  | Â  Â  | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | |
Â Â Â Â | +------+-------+ Â  Â  +---------+---------+ Â  Â  +---------------+---------+-------+ |
Â Â Â Â |Â  Â  Â  Â  | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | Â  Â  Â  Â  Â  Â  Â  Â  |
Â Â Â Â |Â  WAN --+ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | (vmbr1 - LAN) Â  Â  Â  Â  Â  Â  Â  Â  Â  | (vmbr1 - LAN) Â  |
Â Â Â Â |Â  (vmbr0) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | Â  Â  Â  Â  Â  Â  Â  Â  |
Â Â Â Â +--------------------------------+---------------------------------+-----------------+
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â | (vmbr1 - LAN - 10.0.0.0/24)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â +-------+-------+
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â | Â  CLIENT01Â  Â  |
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â |Â  (Win 10/11)Â  |
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â +---------------+

### VLAN 10 (Servers - 10.10.10.0/24) - Optional Segmentation
Â Â Â Â | +---------------------+ Â  Â  +-------------------------------+ |
Â Â Â Â | |Â  DC01 (Win Srv) Â  Â  | Â  Â  |Â  Zabbix (Ubuntu Server) Â  Â  Â  | |
Â Â Â Â | |Â  - Secondary NICÂ  Â  | Â  Â  |Â  - Secondary NICÂ  Â  Â  Â  Â  Â  Â  | |
Â Â Â Â | +----------+----------+ Â  Â  +---------------+---------+-------+ |
Â Â Â Â |Â  Â  Â  Â  Â  Â  |Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | Â  Â  Â  Â  Â  Â  Â  Â  |
Â Â Â Â +------------+----------------------------------+-----------------+


âš™ï¸ Technologies & Specifications

| Component Â  Â  Â  Â  Â  Â  Â  | Technology / VersionÂ  Â  Â  | Role & Details Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |
| ----------------------- | ------------------------- | ------------------------------------------------------------------------------ |
| HypervisorÂ  Â  Â  Â  Â  | Proxmox VE 8.xÂ  Â  Â  Â  Â  Â  | Underlying virtualization platform. Managed via web UI (https://<host-ip>:8006) |
| Identity & Access Â  | Windows Server 2022 Std Â  | Domain Controller (home.lab), AD DS, DNS, DHCP (for lab network) Â  Â  Â  Â  Â  Â  Â  Â  |
| Network SecurityÂ  Â  | pfSense CE 2.7.xÂ  Â  Â  Â  Â  | Core router/firewall, VLAN provisioning, and inter-VLAN routing.Â  Â  Â  Â  Â  Â  Â  Â  |
| MonitoringÂ  Â  Â  Â  Â  | Zabbix Server 6.4 LTS Â  Â  | Centralized monitoring server. Metrics collected via Zabbix Agent 2.Â  Â  Â  Â  Â  Â  |
| Client OS Â  Â  Â  Â  Â  | Windows 11/10 Â  Â  Â  Â  Â  Â  | Domain-joined client for testing GPOs and user authentication.Â  Â  Â  Â  Â  Â  Â  Â  Â  |
| Host System Â  Â  Â  Â  | - Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  | CPU: x86-64 with VT-x/AMD-V enabled. RAM: 32GB (Recommended). Storage: SSD. Â  Â  |

## ğŸ“‚ Project Phases & Technical Implementation

Phase 1: Proxmox VE Virtualization Foundation

Objective: Establish the underlying hypervisor layer.
- Installation: Proxmox VE installed on bare metal from ISO. Filesystem: ext4 (or zfs for advanced setups).
- Network Configuration: Static IP assigned to the Proxmox management interface (vmbr0).
- Post-Install: Verified virtualization support in the kernel (kvm-ok). Updated packages via apt.

Phase 2: Active Directory Domain Services Deployment

Objective: Create a centralized identity and management domain.
- VM Provisioning: Windows Server 2022 VM created with VirtIO drivers for optimal performance. Configuration:
Â Â # Example Proxmox VM Config Snippet for DC01
agent: 1
bios: ovmf
cores: 2
memory: 4096
net0: virtio=BC:24:11:XX:XX:XX,bridge=vmbr1,firewall=1
scsihw: virtio-scsi-single

- Domain Controller Promotion: Server promoted using Install-WindowsFeature AD-Domain-Services. Forest root: home.lab.
- DHCP Scope: Authorized and configured a new IPv4 scope (10.0.0.100-10.0.0.200/24) on the DC.
- Client Integration: Windows 11 client VM created and joined to the domain via Add-Computer PowerShell cmdlet.

Phase 3: Network Segmentation with pfSense

Objective: Implement a secure and segmented network architecture.
- VM Provisioning: pfSense VM created with two virtual NICs:
Â Â - vtnet0 (WAN): Bridged to vmbr0 (host NIC, gets IP from home router).
Â Â - vtnet1 (LAN): Bridged to vmbr1 (lab network, static IP 10.0.0.1/24).
- Services Configuration:
Â Â - Enabled DHCP Server on LAN interface to replace the Windows Server DHCP.
Â Â - Configured System > Advanced > Networking for Hardware Checksum Offloading to Disable.
- VLAN Implementation:
Â Â - Created VLAN 10 (Servers) on pfSense (Interfaces > VLANs).
Â Â - Added new Interface Assignment (OPT1) with static IP 10.10.10.1/24.
Â Â - Configured firewall rules to permit/deny traffic between VLANs.
Â Â - In Proxmox, created a new Linux Bridge (vmbr10) tagged for VLAN 10.
Â Â - Added a secondary network adapter to VMs (DC01, Zabbix) attached to vmbr10.

Phase 4: Infrastructure Monitoring with Zabbix

Objective: Gain observability into lab infrastructure health and performance.
- Server Deployment: Ubuntu Server 22.04 LTS VM provisioned.
- Zabbix Installation: Installed via official repository.
Â Â wget https://repo.zabbix.com/zabbix/6.4/ubuntu/pool/main/z/zabbix-release/zabbix-release_6.4-1+ubuntu22.04_all.deb
sudo dpkg -i zabbix-release_6.4-1+ubuntu22.04_all.deb
sudo apt update
sudo apt install zabbix-server-mysql zabbix-frontend-php zabbix-apache-conf zabbix-sql-scripts zabbix-agent2

- Database Setup: Configured MySQL/MariaDB as the backend database.
- Agent Configuration: Deployed Zabbix Agent 2 on DC01. Edited zabbix_agent2.conf to point to the Zabbix server IP.
- Template Linking: In the Zabbix frontend, host DC01 was created and linked to the Template OS Windows by Zabbix agent template for automatic metric collection.

ğŸ§ª Skills Demonstrated

- Infrastructure as Code (IaC) Mindset: Reproducible environment provisioning via detailed configuration notes.
- Systems Administration: Full lifecycle management of Windows Server (AD DS, DNS, DHCP) and Linux (Ubuntu) systems.
- Networking: Advanced configuration including VLAN trunking, firewall rule sets, static routing, and DHCP relay.
- Monitoring & Observability: Deployment and configuration of a full-stack monitoring solution (Zabbix Server + Agents) with custom alerting.
- Troubleshooting: Diagnosed and resolved issues related to VirtIO drivers, network routing, firewall rules, and agent-server communication.

ğŸ“ Repository Structure

â”œâ”€â”€ /docs
â”‚ Â  â”œâ”€â”€ Phase1_Proxmox-Install.md Â  Â  Â  Â  # Detailed Proxmox installation and host config
â”‚ Â  â”œâ”€â”€ Phase2_Active-Directory.mdÂ  Â  Â  Â  # Step-by-step AD DS and DHCP setup
â”‚ Â  â”œâ”€â”€ Phase3_pfSense-VLANs.md Â  Â  Â  Â  Â  # pfSense config and VLAN setup
â”‚ Â  â”œâ”€â”€ Phase4_Zabbix-Monitoring.md Â  Â  Â  # Zabbix server and agent installation
â”‚ Â  â””â”€â”€ /screenshotsÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # Supporting configuration screenshots
â”œâ”€â”€ /configs
â”‚ Â  â”œâ”€â”€ zabbix_agent2.confÂ  Â  Â  Â  Â  Â  Â  Â  # Example Zabbix Agent 2 config for Windows
â”‚ Â  â””â”€â”€ pfSense-backup.xmlÂ  Â  Â  Â  Â  Â  Â  Â  # Example pfSense configuration export
â”œâ”€â”€ /images
â”‚ Â  â””â”€â”€ Network-Diagram.png Â  Â  Â  Â  Â  Â  Â  # Detailed logical network diagram
â””â”€â”€ README.md


---
This lab is built using free-tier or evaluation software for educational purposes.
